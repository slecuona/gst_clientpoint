using System;
using System.Diagnostics;
using System.Drawing;
using System.Drawing.Drawing2D;
using System.Drawing.Imaging;
using System.IO;
using System.Threading;
using System.Windows.Forms.VisualStyles;
using ClientPoint.Session;
using ClientPoint.Utils;
using static ClientPoint.Utils.ExUtils;

namespace ClientPoint.Espf {
    public class PrintJob {
        private const string SETTINGS_DEF = "GRibbonType=RM_KBLACK;Duplex=NONE";
        private const string COERCIVITY = "l"; // (high or low)
        private const int TRACK = 2;
        
        //1 ISO1 
        //2 ISO2 
        //3 ISO3 
        //4 Sipass 
        //5 Custom2 
        //6 JIS 
        //7 Custom4
        //c1 Sipass
        //c2 Custom2
        //c3 JIS
        //c4 Custom4
        //d Default value
        private const string FORMAT = "2";

        private string _settings;
        private string _sessionId;
        private Client _client;
        private Bitmap _image;

        public PrintJob(Client cl) {
            _client = cl;
            _settings = SETTINGS_DEF;
            var xSettings = Config.EspfSettingsX;
            if (!string.IsNullOrEmpty(xSettings))
                _settings += $";{xSettings}";
        }

        private static void ExecStepOrFail(Func<string> action, string msg) {
            // Haciendo pruebas, con este sleep se reduce el error de
            // "An existing connection was forcibly closed by the remote host"
            Thread.Sleep(100);
            var res = action();
            if (res != "OK")
                throw new Exception($"Error de respuesta impresion ESPF: {msg}");
        }

        public void Start() {
            CreateImage();
            WriteData();
            // El Print por default hace eject.
            Print();
        }

        public void Print() {
            try {
                DieIf(string.IsNullOrEmpty(_client.IdCard),
                    "El cliente no tiene IdCard asignado.");

                // 1 - Begin
                _sessionId = Services.PrintBegin("PRINT1");

                // 2- PrintSet
                ExecStepOrFail(
                    () => Services.PrintSet("PRINT2", _sessionId, _settings),
                    "PrintSet");

                // 3 - SetBitmap
                ExecStepOrFail(
                    () => Services.PrintSetBitmap("PRINT3", _sessionId, GetImageBase64()),
                    "PrintSetBitmap");

                // 4 - Print Start
                ExecStepOrFail(
                    () => Services.PrintStart("PRINT4", _sessionId),
                    "PrintStart");
            }
            catch (Exception ex) {
                throw new Exception("ESPF: Error al ejecutar impresion.", ex);
            }
            finally {
                if (!string.IsNullOrEmpty(_sessionId)) {
                    // 5 - Print End
                    ExecStepOrFail(
                        () => Services.PrintEnd("PRINT5", _sessionId),
                        "PrintEnd");
                }
            }
        }
        
        //private const string BITMAP =
        //    "base64:Qk0+RAEAAAAAAD4AAAAoAAAA+AMAAIgCAAABAAEAAAAAAABEAQAAAAAAAAAAAAAAAAAAAAAAAAAAAP///wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////8P/////w//////D/////8P/////w//////D/////8P/////w//////D/////8P/////w//////D/////8P/////w//////D/////////////////////////////////////////wD/////////////////////////////////gA////+AD////4AP////gA////+AD////4AP////gA////+AD////4AP////gA////+AD////4AP////gA////+AD////4AP////////////////////////////////////////AP////////////////////////////////+AAAAA/4AAAAD/gAAAAP+AAAAA/4AAAAD/gAAAAP+AAAAA/4AAAAD/gAAAAP+AAAAA/4AAAAD/gAAAAP+AAAAA/4AAAAD/gAAAAP////////////////////////////////////8A/////////////////////////////////4AAAAD/gAAAAP+AAAAA/4AAAAD/gAAAAP+AAAAA/4AAAAD/gAAAAP+AAAAA/4AAAAD/gAAAAP+AAAAA/4AAAAD/gAAAAP+AAAAA/////////////////////////////////////wD/////////////////////////////////wAAAAP/AAAAA/8AAAAD/wAAAAP/AAAAA/8AAAAD/wAAAAP/AAAAA/8AAAAD/wAAAAP/AAAAA/8AAAAD/wAAAAP/AAAAA/8AAAAD/////////////////////////////////////AP/////////////////////////////////AAAAA/8AAAAD/wAAAAP/AAAAA/8AAAAD/wAAAAP/AAAAA/8AAAAD/wAAAAP/AAAAA/8AAAAD/wAAAAP/AAAAA/8AAAAD/wAAAAP////////////////////////////////////8A/////////////////////////////////8AAAAD/wAAAAP/AAAAA/8AAAAD/wAAAAP/AAAAA/8AAAAD/wAAAAP/AAAAA/8AAAAD/wAAAAP/AAAAA/8AAAAD/wAAAAP/AAAAA/////////////////////////////////////wD/////////////////////////////////wAAAAP/AAAAA/8AAAAD/wAAAAP/AAAAA/8AAAAD/wAAAAP/AAAAA/8AAAAD/wAAAAP/AAAAA/8AAAAD/wAAAAP/AAAAA/8AAAAD/////////////////////////////////////AP/////////////////////////////////gAAAA/+AAAAD/4AAAAP/gAAAA/+AAAAD/4AAAAP/gAAAA/+AAAAD/4AAAAP/gAAAA/+AAAAD/4AAAAP/gAAAA/+AAAAD/4AAAAP////////////////////////////////////8A/////////////////////////////////+AAAAD/4AAAAP/gAAAA/+AAAAD/4AAAAP/gAAAA/+AAAAD/4AAAAP/gAAAA/+AAAAD/4AAAAP/gAAAA/+AAAAD/4AAAAP/gAAAA/////////////////////////////////////wD/////////////////////////////////4AAAAH/gAAAAf+AAAAB/4AAAAH/gAAAAf+AAAAB/4AAAAH/gAAAAf+AAAAB/4AAAAH/gAAAAf+AAAAB/4AAAAH/gAAAAf+AAAAB/////////////////////////////////////AP/////////////////////////////////gAAAAf+AAAAB/4AAAAH/gAAAAf+AAAAB/4AAAAH/gAAAAf+AAAAB/4AAAAH/gAAAAf+AAAAB/4AAAAH/gAAAAf+AAAAB/4AAAAH////////////////////////////////////8A//////////////////////////////////AAAAB/8AAAAH/wAAAAf/AAAAB/8AAAAH/wAAAAf/AAAAB/8AAAAH/wAAAAf/AAAAB/8AAAAH/wAAAAf/AAAAB/8AAAAH/wAAAAf////////////////////////////////////wD/////////////////////////////////8AAAAD/wAAAAP/AAAAA/8AAAAD/wAAAAP/AAAAA/8AAAAD/wAAAAP/AAAAA/8AAAAD/wAAAAP/AAAAA/8AAAAD/wAAAAP/AAAAA/////////////////////////////////////AP/////////////////////////////////wAAAAP/AAAAA/8AAAAD/wAAAAP/AAAAA/8AAAAD/wAAAAP/AAAAA/8AAAAD/wAAAAP/AAAAA/8AAAAD/wAAAAP/AAAAA/8AAAAD////////////////////////////////////8A//////////////////////////////////gAAAA/+AAAAD/4AAAAP/gAAAA/+AAAAD/4AAAAP/gAAAA/+AAAAD/4AAAAP/gAAAA/+AAAAD/4AAAAP/gAAAA/+AAAAD/4AAAAP////////////////////////////////////wD/////////////////////////////////+AAAAD/4AAAAP/gAAAA/+AAAAD/4AAAAP/gAAAA/+AAAAD/4AAAAP/gAAAA/+AAAAD/4AAAAP/gAAAA/+AAAAD/4AAAAP/gAAAA/////////////////////////////////////AP////////////////////////////////////4AP////gA////+AD////4AP////gA////+AD////4AP////gA////+AD////4AP////gA////+AD////4AP////gA////+AD////////////////////////////////////8A//////////////////////////////////////w//////D/////8P/////w//////D/////8P/////w//////D/////8P/////w//////D/////8P/////w//////D/////8P////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP/////////z///////////////4AH////////+AAAP//////D////////////gAf/////////////////////////////////////////////////////////////////////////////////////////8///////////////8A///AAAAAAAH///+AAH///////4AAB////+AAAAAAAfwAAP/4B///////////gAAH//AAB////wAAH4AAH//gAAPwAAAAAf////////gAAP//////wAAP//AAAfgAAf8AAD////AAD///gAAf//wAAAAAAB/wAAP//AAAf////wD//8AAAAAAAf///4AAP//////8AAAA////4AAAAAAB+AAA//gA//////////wAAAH/4AAD///+AAAfAAAf/8AAA+AAAAAAP///////+AAA//////+AAA//4AAB8AAB/wAAP///4AAP//8AAB///AAAAAAAH+AAA//4AAB/////AP//wAAAAAAA////AAA///////AAAAA////gAAAAAAH4AAD/8AA/////////8AAAAH/wAAP///4AAB8AAB//wAAH4AAAAAAH///////4AAD//////4AAD//gAAPwAAH/AAA////AAA///wAAH//8AAAAAAAP4AAD//gAAP////8A///AAAAAAAD///8AAB//////wAAAAA///+AAAAAAAfgAAP/gAA/////////AAAAAH/AAA////gAAPwAAH//AAAfgAAAAAAH///////gAAP//////gAAP/+AAA/AAAf8AAD///8AAD///AAAf//wAAAAAAA/gAAP/+AAA/////wD//8AAAAAAAP///gAAH/////+AAAAAB///4AAAAAAB+AAA/+AAB////////4AAAAAH8AAB///+AAA/AAAf/4AAD+AAAAAAAP//////+AAB//////+AAA//wAAH8AAB/wAAP///gAAP//8AAB///AAAAAAAD+AAA//wAAH/////AP//wAAAAAAA///+AAAP/////gAAAAAB///gAAAAAAD4AAD/wAAD////////AAAAAAP4AAH///wAAD8AAB//gAAP4AAAAAAAP//////4AAH//////4AAD//AAAfwAAH/AAA///8AAA///wAAH//8AAAAAAAP4AAD//AAAf////8A///AAAAAAAD///wAAAf////8AAAAAAD//+AAAAAAAPgAAP/AAAD///////wAAAAAAfgAAf///AAAfwAAH/+AAB/gAAAAAAAf//////gAAf//////gAAP/8AAD/AAAf8AAD///gAAD///AAAf//wAAAAAAA/gAAP/8AAD/////wD//8AAAAAAAP///AAAB/////gAAAAAAH//4AAAAAAA+AAA/4AAAH//////+AAAAAAA+AAA///8AAB/AAAf/wAAH+AAAAAAAA//////+AAB//////+AAA//gAAP8AAB/wAAP//+AAAP//8AAB///AAAAAAAD+AAA//gAAP/////AP//wAAAAAAA///4AAAD////8AAAAAAAP//gAAAAAAD4AAD/gAAAP//////wAAAAAAB8AAD///gAAH8AAB//AAAf8AAAAAAAB//////4AAH//////4AAD/+AAA/wAAH/AAA///wAAA///wAAH//8AAAAAAAP4AAD/+AAA/////8A///AAAAAAAB///gAAAP////gAAAAAAAf/+AAAAAAAPwAAP8AAAAf/////+AAAAAAADwAAAAAAAAA/wAAH/8AAD/wAAAAAAAD//////gAAf//////gAAP/4AAH/gAAf8AAD//+AAAD///AAAf//wAAAAAAAfgAAP/4AAH/////wD//8AAAAAAAH//8AAAAf///8AAAAAAAA//4AAAAAAA/AAA/wAAAB//////4AAAAAAAPgAAAAAAAAD/AAAf/gAAP/AAAAAAAAH/////+AAB//////+AAA//AAAf+AAB/wAAP//wAAAP//8AAB///AAAAAAAB+AAA//AAAf/////AP//4AAAAAAAf//wAAAB////gAAAAAAAB//gAAAAAAD8AAD+AAAAD//////AAAAAAAA+AAAAAAAAAf8AAB/+AAB/8AAAAAAAAP/////4AAH//////4AAD/8AAD/4AAH/AAA///AAAA///wAAH//+AAAAAAAH4AAD/8AAD/////8A///gAAAAAAB//+AAAAD///+AAAAAAAAH/+AAAAAAAPwAAP4AAAAH/////4AAAAAAAD4AAAAAAAAB/wAAP/wAAH/wAAAAAAAA//////gAAf//////gAAf/gAAP/gAAf8AAD//4AAAD///gAAf//4AAAAAAAfgAAf/gAAP/////wD//+AAAAAAAH//4AAAAP///wAAAAAAAAP/4AAAAAAA/AAA/gAAAAf/////gAAAAAAAfwAAAAAAAAH/gAA//AAA//AAAf+AAAB/////+AAB///////AAB/+AAB/+AAB/wAAP//AAAAP//+AAB///gAAAAAAB/AAB/+AAB//////AP//4AAAAAAAf//AAAAAf//+AAAAAAAAAf/gAAAAAAD8AAD+AAAAA/////8AAAAAAAD/AAAAAAAAA/+AAD/8AAD/8AAH//AAAH/////4AAAAAH///8AAH/4AAH/4AAH/gAA//4AAAA///4AAH//+AAAAAAAH8AAH/4AAH/////8A///gAAH//4B//8AAAAB///4AAAAAAAAB/+AAD//gAPwAAP/gAAAD/////gAAAAAAAP8AAAAAAAAD/4AAP/gAAf/wAAf/+AAAP/////gAAAAAB///wAAf/AAA//gAAf+AAD//gAAAD///gAAf//4AAB//+AfwAAf/AAA//////wD//+AAB///////gAAAAD///AAAAf4AAAD/4AAP/////AAA//4AAAP////+AAAA/wAB/4AAAAAAAAP/gAA/+AAB//AAB//+AAAf////+AAAAAAB///AAB/8AAD/+AAB/4AAP/8AAAAP//+AAB///gAAf/////AAB/8AAD//////AP//4AAH//////+AAAAAP//8AAAP/4AAAP/gAA/////8AAD//4AAAf////wAAAf/4AP/gAAAAAAAB/+AAD/wAAP/8AAH//8AAB/////4AAAAAAB//8AAH/gAAf/4AAH/gAA//gAAAA///4AAH//+AAB/////8AAH/gAAf/////8A///gAAf//////wAAAAAf//gAAD//4AAAf+AAD/////wAAP//wAAB/////AAAH//wA/+AAAAAAAAH/4AAP/AAA//wAAf//4AAH/////gAAAAAAD//wAAf+AAB//gAAf+AAD/8AAAAD///gAAf//4AAH/////wAAf+AAB//////wD//+AAB///////AAAAAB//+AAAf//wAAB/4AAP/////AAA///gAAH////8AAA///wH/8AAAAAAAA//gAA/4AAD//AAB///gAAP////+AAAAAAAH//AAB/wAAH/+AAB/4AAP/wAAAAP//+AAB///gAAf/////AAB/wAAH//////AP//4AAH//////4AAAAAD//4AAD///gAAH/gAA/////8AAD///AAAf////gAAH///g//wAAAAAAAD/+AAD/gAAf/8AAH///AAA/////4AAAAAAAP/8AAH/AAA//4AAH/gAA/+AAAAA///4AAH//+AAB/////8AAH/AAA//////8A///gAAf//////gAAwAAP//AAAf///AAAP+AAD/////wAAP//8AAB////+AAAf///D//gAAAAAAAP/4AAP8AAB//wAAf//8AAB/////gAAAAAAAf/wAAf4AAD//gAAf+AAD/wAAAAD///gAAf//4AAH/////wAAf4AAD//////wD//+AAB//////8AADgAAf/8AAD///+AAA/4AAP/////AAA///wAAH////4AAD////f/+AAAAAAAB//gAAAAAAP//AAB///4AAH////+AAAAAAAA//AAAAAAAf/+AAB/4AAP/AAAAAP//+AAB///gAAf/////AAAAAAAf//////AP//4AAH//////wAAeAAB//wAAP///8AAD/gAA/////8AAD///AAAf////gAAf//////4AAAAAAAH/+AAAAAAA//8AAH///gAAf////4AAAAAAAB/8AAAAAAB//4AAH/gAA/4AAAAA///4AAH//+AAB/////8AAAAAAB//////8A///gAAf//8f/+AAB8AAD/+AAB////wAAH+AAD/////wAAP//8AAB////8AAB///////wAAf/AAA//4AAAAAAH//wAAf///AAB/////gAAAAAAAH/wAAAAAAP//gAAf+AAD/AAAAAD///gAAf//4AAH///H/wAAAAAAP//////wD//+AAAAAAB//4AAPwAAP/4AAH////gAAf4AAP/////AAA///wAAH////wAAP///////AAB/8AAD//gAAAAAAf//AAB///8AAD////+AAAAAAAAP/AAAAAAA//+AAB/4AAP4AAAAAP//+AAB///gAAAAAAf/AAAAAAA///////AP//4AAAAAAH//AAA/gAAf/gAA////+AAB/gAA/////8AAD//+AAA/////AAA///////8AAH/wAAP/+AAAAAAA//8AAH///wAAP////4AAAAAAAA/8AAAAAAB//4AAH/gAA/gAAAAA///4AAH//+AAAAAAB/8AAAAAAB//////8A///gAAAAAAf/8AAH+AAB/+AAD////8AAH+AAD/////wAAP//4AAD////8AAD///////4AAP/AAB//4AAAAAAA//wAAf///AAA/////gAAAAAAAB/wAAAAAAB//gAAf+AAD8AAAAAD///gAAf//4AAAAAAH/wAAAAAAB//////wD//+AAAAAAB//gAAf8AAD/4AAP////wAAf4AAP/////AAA///AAAP////wAAP///////gAA/8AAH//gAAAAAAB//AAB///+AAD////+AAB/+AAAH/AAAAAAAD/+AAB/4AAPgAAAAAP//+AAB///gAAAAAAf/AAAAAAAD//////AP//4AAAAAAH/+AAD/wAAP/gAA/////AAB/gAA/////8AAD//4AAB/////AAB////////AAD/gAAf/+AAAAAAAD/8AAH///4AAP////4AAP/+AAAf8AAAAAAAH/4AAH/gAA8AAAgAA///4AAH//+AAAAAAB/8AAAAAAAH/////8A///gAAAAAAf/wAAP/gAAf+AAD////8AAH+AAD/////wAAP//AAAH////8AAH///////8AAH+AAD//4AAAAAAAH/wAAf///gAA/////gAA//8AAA/wAAAAAAAP/gAAf+AADgAAGAAD///gAAf//4AAAAAAH/wAAAAAAAP/////wD//+AAAAAAB//AAB/+AAB/4AAP////wAAf4AAP/////AAA//8AAA/////wAAf///////wAAf4AAP//gAAAAAAAP/AAB///+AAD////+AAD//4AAD/AAAAAAAAf+AAB/4AAOAAA8AAP//+AAB///gAAAAAAf/AAAAAAAAf/////AP//4AAAAAAH/4AAH/8AAD/gAA/////AAB/gAA/////8AAD//gAAH/////AAB////////gAB/AAB//+AAAAAAAA/8AAH///4AAP////4AAP//wAAP8AAAAAAAB/4AAH/gAAwAADwAA///4AAH//+AAAAAAB/8AAAAAAAB/////8A///gAAAAAAP/gAA//wAAP+AAD////8AAH+AAD/////wAAP/8AAAf////8AAH///////+AAD8AAH//4AAAAAAAB/wAAf///gAA/////gAA///AAA/wAAAAAAAD/gAAf+AACAAAfAAD///gAAf//4AAAAAAD/wAAAAAAAD/////wD//+AAAAAAA/8AAD//gAAf4AAP////wAAf4AAP/////AAA//gAAD/////wAAf///////4AAPwAAf//gAAf/AAAH/AAB///+AAD////+AAD//8AAD/AAA/+AAAP+AAB/4AAAAAD8AAP//+AAB///gAAAAAAP/AAA/+AAAP/////AP//4AAAAAAD/wAAf/+AAB/gAA/////AAB/gAA/////8AAD/8AAAf/////AAB////////wAA+AAD//+AAD//AAAP8AAH///4AAP////4AAP//4AAH8AAH/+AAAf4AAH/gAAAAAfwAA///4AAH//+AAAAAAA/8AAH/+AAAf////8A///gAAAAAAP+AAB//8AAH+AAD////8AAH+AAD/////wAAP/wAAD/////8AAD////////AAB4AAP//4AAP/+AAA/wAAf///AAA/////gAA///gAAfwAAf/8AAB/gAAf+AAAAAB/AAD///gAAf//4AAAAAAD/wAAf/8AAB/////wD//+AAAAAAA/4AAH//wAAP4AAP////wAAf4AAP/////AAA/+AAAP/////wAAP///////+AAHgAB///gAA//8AAD/AAB///8AAD////+AAD//+AAB/AAB//4AAH+AAB/4AAAAAP8AAP//+AAB///gAAAAAAP/AAB//4AAH/////AP//4AAAAAAD/gAA///AAA/gAAf///+AAB/gAA/////8AAD/wAAB//////AAA////////4AAcAAH//+AAD//wAAP8AAH///wAAP////4AAP//4AAH8AAH//gAAf4AAH/gAAAAB/wAA///4AAH//+AAAAAAA/8AAH//gAAf////8A///gAAAAAAP8AAD//+AAB+AAB////4AAH+AAD/////wAAP/AAAP/////8AAD////////gAAwAAf//4AAP//gAAfwAAf///AAB/////gAA///gAAfwAAf//AAA/gAAf+AAAAAP+AAD///gAAf//4AAAAAAD/wAAf//AAA/////wD//+AAA///A/wAAP//4AAH4AAD////AAA/4AAP/////AAA/8AAB//////wAAH////////AADAAD///gAA//+AAB/AAB///4AAH////+AAD//+AAB/AAB//8AAD+AAB/4AAAAA/4AAP//+AAB///gAAP//wP/AAB//8AAD/////AP//4AAH/////AAA///gAAfwAAP///8AAD/gAA/////8AAD/gAAH//////gAAf///////8AAAAAP//+AAD//4AAH8AAH///gAAf////4AAP//4AAH8AAH//wAAP4AAH/gAAAAH/gAA///4AAH//+AAB/////8AAH//wAAP////8A///gAAf////8AAD//+AAB/AAAf///gAAP+AAD/////wAAP+AAA//////+AAA////n///wAAAAB///4AAP//gAAfwAAf//8AAB/////gAA///AAAfwAAf//AAA/gAAf+AAAAA/+AAD///gAAf//4AAH/////wAAf//AAA/////wD//+AAB/////wAAP//4AAH8AAA///+AAA/4AAP/////AAA/4AAD//////4AAD///8P///gAAAAH///gAA//+AAB/AAB///wAAP////+AAD//8AAB/AAB//8AAD+AAB/4AAAAD/4AAP//+AAB///gAAf/////AAB//8AAD/////AP//4AAH/////AAA///gAAf4AAB///wAAH/gAA/////8AAD/gAAf//////gAAH///gf//+AAAAAf//+AAD//4AAH8AAH//+AAA/////4AAP//wAAP8AAH//wAAP4AAH/gAAAAf/gAA///4AAH//+AAB/////8AAH//wAAP////8A///gAAf////8AAD//+AAB/gAAD//+AAAf+AAB/////wAAP+AAB///////AAAP//8B///4AAAAD///4AAP//gAAfwAAf//wAAH/////gAA//+AAA/wAAf//AAA/gAAf+AAAAD/+AAD///gAAf//4AAH/////wAAf//AAA/////wD//+AAB/////wAAP//4AAH+AAAH//gAAB/4AAH/////AAA/4AAH//////8AAAf//AD///wAAAAP///gAA//8AAB/AAB//+AAAf////+AAD//4AAD/AAB//4AAD+AAB/4AAAAf/4AAP//+AAB///gAAf/////AAB//4AAD/////AP//4AAH/////AAA///gAAf8AAAH/8AAAP/gAAf////8AAD/gAAf//////4AAAf/wAH///AAAAB///+AAD//wAAH8AAH//wAAB/////4AAP//AAAP8AAH//gAAP4AAH/gAAAB//gAA///4AAH//+AAB/////8AAH//gAAP////8A///gAAf//gD8AAD//+AAB/wAAAH+AAAA/+AAB/////wAAP+AAA///////gAAAP8AAf//+AAAAH///4AAP/+AAAfwAAf/+AAAP/////gAA//4AAB/wAAf/8AAA/gAAf+AAAAP/+AAD///gAAf//4AAH//4A/wAAf/8AAA/////wD//+AAAAAAAPwAAP//4AAH/gAAAAAAAAH/4AAH/////AAA/4AAB///////AAAAAAAA///4AAAAf///gAA//gAAD/AAB//gAAB/////+AAB/8AAAH/AAB//AAAH+AAB/4AAAB//4AAPwA+AAB+AfgAAAAAAD/AAB//AAAH/////AP//4AAAAAAA/AAA///gAAf+AAAAAAAAA//gAAf////8AAD/gAAB//////8AAAAAAAD///gAAAD///+AAB/wAAAP8AAB/wAAAH/////4AAAAAAAAf8AAD/gAAAf4AAH/AAAAH//gAA/AAAAAAAB+AAAAAAAP8AAD/gAAAf////8A///gAAAAAAH8AAD//+AAB/8AAAAAAAAD/+AAB/////wAAP+AAAAB/////4AAAAAAAH///AAAAP///4AAAAAAAA/wAAAAAAAA//////gAAAAAAAD/wAAAAAAAB/gAAf8AAAA//+AAD8AAAAAAAH4AAAAAAB/wAAAAAAAB/////wD//+AAAAAAAfwAAP//4AAH/4AAAAAAAAf/4AAH/////AAA/8AAAAP/////gAAAAAAAf//8AAAB////gAAAAAAAH/AAAAAAAAD/////+AAAAAAAAf/AAAAAAAAP+AAB/wAAAH//4AAHwAAAAAAAfgAAAAAAH/AAAAAAAAP/////AP//4AAAAAAB/AAAf//gAAf/gAAAAAAAD//gAAf////8AAD/wAAAA//////AAAAAAAA///wAAAH///+AAAAAAAAf8AAAAAAAAf/////4AAAAAAAB/8AAAAAAAA/4AAH/AAAA///gAAfAAAAAAAB+AAAAAAAf8AAAAAAAA/////8A///gAAAAAAH8AAB//+AAB//AAAAAAAAP/+AAB/////wAAP/gAAAH/////+AAAAAAAD///gAAAf///4AAAAAAAD/wAAAAAAAD//////gAAAAAAAP/wAAAAAAAH/gAAf8AAAD//+AAB+AAAAAAAH4AAAAAAB/wAAAAAAAH/////wD//+AAAAAAAfwAAH//4AAH/+AAAAAAAB//4AAH/////AAA/+AAAAf/////8AAAAAAAP//+AAAD////gAAAAAAAP/AAAAAAAAf/////+AAAAAAAB//AAAAAAAAf+AAB/wAAAf//4AAH4AAAAAAAfgAAAAAAH/AAAAAAAAf/////AP//4AAAAAAB/AAAf//gAAf/8AAAAAAAP//gAAf////8AAD/8AAAD//////4AAAAAAB///8AAAP///+AAAAAAAB/4AAAAAAAD//////wAAAAAAAP/8AAAAAAAD/4AAH/AAAD///gAAfgAAAAAAB+AAAAAAAf8AAAAAAAD/////8A///gAAAAAAH8AAB//+AAB//4AAAAAAB//+AAB/////wAAH/4AAAP//////wAAAAAAH///wAAB////4AAAAAAAP/gAAAAAAAf//////AAAAAAAB//wAAAAAAAf/gAAP8AAAf//+AAB+AAAAAAAH4AAAAAAB/wAAAAAAAf/////wD//+AAAAAAAfwAAH//4AAH//wAAAAAAP//4AAH/////AAAf/wAAA///////gAAAAAA////AAAH////gAAAAAAB/+AAAAAAAH//////8AAAAAAAP//AAAAAAAD/+AAA/wAAB///4AAH4AAAAAAAfgAAAAAAH/AAAAAAAD//////AP//wAAAAAAB/AAAf//gAAf//gAAAAAD///gAAf////8AAB//gAAH///////AAAAAAP///+AAAf///8AAAAAAAP/4AAAAAAA///////wAAAAAAB//4AAAAAAAf/4AAD/AAAP///gAAfgAAAAAAB8AAAAAAAf4AAAAAAAf/////8A///AAAAAAAH8AAB//+AAB///gAAAAAf//+AAB/////wAAH//gAAf//////+AAAAAB////4AAD////wAAAAAAD//gAAAAAAP///////AAAAAAAf//gAAAAAAH//gAAP8AAB///+AAB+AAAAAAAHwAAAAAAB/gAAAAAAH//////wD//8AAAAAAAfwAAH//4AAH///AAAAAD///4AAH/////AAAf//AAD///////8AAAAAP////gAAP////AAAAAAA//+AAAAAAH///////8AAAAAAH//+AAAAAAB//+AAA/wAAH///4AAH4AAAAAAAfAAAAAAAH+AAAAAAB///////AP//wAAAAAAD/AAAf//gAAf///AAAAA////gAAf////8AAB///AAP///////8AAAAD/////AAB////8AAAAAAP//4AAAAAD////////wAAAAAB///4AAAAAAf//4AAD/AAA////gAAfwAAAAAAB8AAAAAAA/4AAAAAAf//////8A///AAAAAAAP+AAD//+AAB////AAAAP///+AAB/////wAAH///AB////////8AAAA/////8AAH////8AAAAAP///wAAAAP/////////gAAAAD////4AAAAAf///gAAP8AAH///+AAB/A////+AHwAAAAAAD/4AAAAAf///////wD/////////////////////////gAAH////////////////////gH////////+AAAf////////////////////////////////////////////////////////////////g////////////////////////////////////////AP/////////////////////////4AH/////////////////////4f/////////gAf/////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP/////////////////////////////////////////////////////+P/8P/////////////////h////////////////////////////////gAD/////////////////////////////////////////////////////////8A/////////////////////////////////////////AAAP//4AAAAAAAf/gH/////+AAAf//////8A////4AAAAAH////+AAA///wAA//////AAAA/////////////////////////////////////////////////////////wD////////////////////////////////////////8AAA///gAAAAAAB/+AD/////4AAB///////wAf///AAAAAAD////wAAD//8AAA/////AAAAA/////////////////////////////////////////////////////////AP////////////////////////////////////////wAAD//+AAAAAAAH/wAD/////gAAH//////+AAf//8AAAAAAB////AAAP//gAAD////wAAAAA////////////////////////////////////////////////////////8A/////////////////////////////////////////AAAP//4AAAAAAAP/AAD////+AAAf//////4AAf//4AAAAAAB///8AAA//+AAAP///8AAAAAA////////////////////////////////////////////////////////wD////////////////////////////////////////8AAA///gAAAAAAA/4AAD////4AAB///////AAAf//gAAAAAAB///wAAD//wAAB////4AAAAAB////////////////////////////////////////////////////////AP////////////////////////////////////////wAAD//+AAAAAAAD/AAAH////gAAH//////4AAA//+AAAAAAAD///AAAP//AAAH////gAAAAAD///////////////////////////////////////////////////////8A/////////////////////////////////////////AAAP//4AAAAAAAP8AAAP///+AAAf//////gAAB//4AAAAAAAH//8AAA//4AAAf///+AAAAAAH///////////////////////////////////////////////////////wD////////////////////////////////////////8AAA///gAAAAAAA/gAAAf///4AAB//////8AAAD//gAAAAAAAP//wAAD//gAAD////8AAAAAAP///////////////////////////////////////////////////////AP////////////////////////////////////////wAAD//+AAAAAAAD+AAAA////gAAH//////wAAAH/+AAAAAAAAf//gAAP/8AAAP////wAAAAAA///////////////////////////////////////////////////////8A/////////////////////////////////////////AAAP//4AAAAAAAHwAAAB///+AAAf/////+AAAAP/4AAAAAAAA//+AAA//wAAB/////gAAAAAB///////////////////////////////////////////////////////wD////////////////////////////////////////8AAA///gAAAAAAAfAAAAD///4AAB//////4AAAAf/gAAAAAAAB//4AAD/+AAAP////+AAAAAAH///////////////////////////////////////////////////////AP////////////////////////////////////////wAAH//+AAAAAAAB4AAAAH///gAAP//////AAAAA/+AAAAAAAAD//gAAP/wAAA/////4AAAAAAP//////////////////////////////////////////////////////8A/////////////////////////////////////////AAAf//4AAAAAAAHgAAAAf//+AAA//////8AAAAD/4AAAAAAAAH/+AAA//AAAH/////gAAAAAA///////////////////////////////////////////////////////wD////////////////////////////////////////8AAB///wAAAAAAAeAAAAA///4AAD//////wAAAAH/gAAAAAAAAf/4AAD/4AAAf/////AH+AAAD///////////////////////////////////////////////////////AP////////////////////////////////////////wAAH///AAAAAAAB4AAAAD///gAAP//////AAAAAf+AAAf+AAAA//gAAf/gAAD/////8H//AAAP//////////////////////////////////////////////////////8A/////////////////////////////////////////AAAf//8AAAf//gH+AAAAH//+AAA///////wAAAA/4AAH//AAAB/+AAB/8AAAP/////z//+AAA///////////////////////////////////////////////////////wD////////////////////////////////////////8AAB///wAAH//////gAAAf//4AAD///////8AAAD/gAAf/+AAAH/4AAH/wAAB/////////4AAD///////////////////////////////////////////////////////AP////////////////////////////////////////wAAH///AAAf//////gAAB///gAAP///////8AAAP+AAB//+AAAP/gAAf+AAAP/////////wAAP//////////////////////////////////////////////////////8A/////////////////////////////////////////AAAf//8AAD///////AAAD//+AAA////////4AAAf4AAH//8AAA/+AAB/4AAA//////////AAA///////////////////////////////////////////////////////wD////////////////////////////////////////8AAB///wAAP//////+AAAP//4AAD////////wAAB/gAAf//4AAB/4AAH/AAAH/////////8AAD///////////////////////////////////////////////////////AP////////////////////////////////////////wAAH///AAA///////8AAA///gAAP////////gAAH+AAB///wAAH/gAAf8AAAf/////////wAAP//////////////////////////////////////////////////////8A/////////////////////////////////////////AAAf//8AAD///////wAAD//+AAA////////+AAAf4AAH///AAAf+AAB/gAAD/////////+AAA///////////////////////////////////////////////////////wD////////////////////////////////////////8AAB///wAAP///////gAAP//4AAD////////8AAB/gAAf//+AAA/4AAH8AAAf/////////wAAH///////////////////////////////////////////////////////AP////////////////////////////////////////4AAH///AAA///////+AAA///wAAP////////wAAH+AAB///4AAD/gAAPwAAB/////////8AAAf//////////////////////////////////////////////////////8A/////////////////////////////////////////gAAf//8AAD///////4AAD///AAA/////////AAAf4AAH///wAAP+AAAGAAAP//////+AAAAAD///////////////////////////////////////////////////////wD////////////////////////////////////////+AAB///wAAH///H///AAAP//8AAD////////4AAB/gAAf///AAA/4AAAAAAB///////wAAAAAf///////////////////////////////////////////////////////AP////////////////////////////////////////4AAH///AAAAAAAf//8AAA///wAAP////////gAAH+AAB///8AAD/gAAAAAAH///////AAAAAB///////////////////////////////////////////////////////8A/////////////////////////////////////////gAAf//8AAAAAAB///wAAH///AAA////////+AAA/4AAH///4AAH+AAAAAAA///////8AAAAAP///////////////////////////////////////////////////////wD////////////////////////////////////////+AAB///wAAAAAAH//+AAAf//8AAD////////wAAD/gAAf///gAAf4AAAAAAD///////wAAAAD////////////////////////////////////////////////////////AP////////////////////////////////////////4AAH///AAAAAAAf//wAAB///wAAP///////+AAAP+AAB///+AAB/gAAAAAAf///////AAAAAf///////////////////////////////////////////////////////8A/////////////////////////////////////////gAAf//8AAAAAAB//+AAAP///AAA////////wAAB/4AAH///4AAH+AAAAAAD///////8AAAAP////////////////////////////////////////////////////////wD////////////////////////////////////////+AAB///wAAAAAAH//4AAA///8AAD////////AAAH/gAAf///gAAf4AAAAAAP///////wAAAAP////////////////////////////////////////////////////////AP////////////////////////////////////////4AAH///AAAAAAAf//AAAH///wAAP///////4AAA/+AAB///+AAB/gAAAAAB////////AAAAAf///////////////////////////////////////////////////////8A/////////////////////////////////////////gAAf//8AAAAAAB//4AAA////AAA////////AAAH/4AAH///4AAH+AAAAAAH///////+AAAAA////////////////////////////////////////////////////////wD////////////////////////////////////////+AAB///wAAAAAAH//AAAH///8AAD///////4AAA//gAAf///gAAf4AAAAAAP///////4AAAAB////////////////////////////////////////////////////////AP////////////////////////////////////////4AAH///AAAAAAAP/4AAAf///wAAP///////AAAD/+AAB///+AAB/gAAAAAAf///////gfwAAD///////////////////////////////////////////////////////8A/////////////////////////////////////////gAAf//8AAAAAAA//AAAD////AAA///////4AAAf/4AAH///4AAH+AAAAAAAf/////////wAAH///////////////////////////////////////////////////////wD////////////////////////////////////////+AAB///wAAAAAAD/8AAAf///8AAD///////gAAD//gAAf///gAAf4AAAAAAA//////////AAAf///////////////////////////////////////////////////////AP////////////////////////////////////////4AAH///AAAAAAAP/gAAD////wAAP//////8AAAf/+AAB///+AAB/gAAAAAAD/////////+AAA///////////////////////////////////////////////////////8A/////////////////////////////////////////gAAf//8AAAAAAA/+AAAP////AAA///////wAAB//4AAH///wAAH+AAAAAAAH/////////wAAD///////////////////////////////////////////////////////wD////////////////////////////////////////+AAB///wAAAAAAD/wAAB////8AAD//////+AAAP//gAAf///AAA/4AAD8AAAP/////////AAAP///////////////////////////////////////////////////////AP////////////////////////////////////////4AAH///AAAP//wP/AAAP////wAAP//////4AAB//+AAB///8AAD/gAAf8AAAf/////8//4AAA///////////////////////////////////////////////////////8A/////////////////////////////////////////gAAf//8AAB/////4AAB/////AAA///////AAAP//4AAH///gAAP+AAB/4AAB//////wP+AAAD///////////////////////////////////////////////////////wD////////////////////////////////////////+AAB///wAAP/////gAAH////8AAD//////8AAA///gAAf//+AAA/4AAH/wAAD//////AAAAAAP///////////////////////////////////////////////////////AP////////////////////////////////////////4AAH///AAA/////+AAA/////wAAP//////wAAH//+AAB///wAAH/gAAf/gAAP/////8AAAAAA///////////////////////////////////////////////////////8A/////////////////////////////////////////gAAf//8AAD/////4AAD/////AAA///////AAAf//4AAH//+AAAf+AAB//AAAf/////wAAAAAD///////////////////////////////////////////////////////wD////////////////////////////////////////+AAB///wAAP/////gAAP////8AAD//////8AAB///gAAf//4AAD/4AAH/8AAB/////+AAAAAAP///////////////////////////////////////////////////////AP////////////////////////////////////////4AAH///AAA/////+AAA/////wAAP//////wAAH//+AAB///AAAP/gAAf/4AAD/////4AAAAAB///////////////////////////////////////////////////////8A/////////////////////////////////////////gAAf//8AAD/////4AAD/////AAA///////AAAf//4AAH//4AAA/+AAB//gAAP/////gAAAAAH///////////////////////////////////////////////////////wD////////////////////////////////////////+AAB///wAAP/////gAAP////8AAD//////8AAB///gAAf/+AAAH/4AAH//AAAf////+AAAAAA////////////////////////////////////////////////////////AP////////////////////////////////////////4AAH///AAAf//gH+AAAf////wAAP//////wAAD//+AAB//gAAAf/gAAf/8AAB/////4AAAAAH///////////////////////////////////////////////////////8A//////////////////////////////////////4AfgAAfgD8AAAAAAAP4AAA//wA/AAA/AH////AAAH//4AAB/wAAAD/+AAB//4AAH/////gAAAAA////////////////////////////////////////////////////////wD//////////////////////////////////////gAAAAAAAPwAAAAAAB/gAAA//AAAAAAAAf///8AAAH//gAAAAAAAAf/4AAH//gAAP////+AAAAAH////////////////////////////////////////////////////////AP/////////////////////////////////////+AAAAAAAA/AAAAAAAH/AAAAA8AAAAAAAB////4AAAAH+AAAAAAAAB//gAAf/+AAA/////8AAAAB////////////////////////////////////////////////////////8A//////////////////////////////////////4AAAAAAAD8AAAAAAAf8AAAAHwAAAAAAAH////gAAAA/4AAAAAAAAP/+AAB//8AAB/////4AAAAf////////////////////////////////////////////////////////wD//////////////////////////////////////wAAAAAAAPwAAAAAAB/4AAAAfgAAAAAAAf////AAAAD/gAAAAAAAB//4AAH//wAAH/////8AAAH/////////////////////////////////////////////////////////AP//////////////////////////////////////AAAAAAAA/AAAAAAAH/gAAAD+AAAAAAAB////8AAAAf+AAAAAAAAP//gAAP//AAAf//////wAH/////////////////////////////////////////////////////////8A//////////////////////////////////////8AAAAAAAD8AAAAAAAf/AAAAP4AAAAAAAH////4AAAB/4AAAAAAAB//+AAA//+AAA///////////////////////////////////////////////////////////////////wD//////////////////////////////////////wAAAAAAAPwAAAAAAB/+AAAB/gAAAAAAAf////wAAAP/gAAAAAAAP//4AAD//4AAD///////////////////////////////////////////////////////////////////AP//////////////////////////////////////AAAAAAAA/AAAAAAAH/8AAAH+AAAAAAAB/////gAAA/+AAAAAAAB///AAAP//gAAP//////////////////////////////////////////////////////////////////8A//////////////////////////////////////8AAAAAAAD4AAAAAAAf/4AAA/4AAAAAAAH/////AAAH/4AAAAAAAP//8AAA///AAA///////////////////////////////////////////////////////////////////wD//////////////////////////////////////wAAAAAAAPgAAAAAAB//wAAD/gAAAAAAAf////+AAAf/gAAAAAAD///wAAD//8AAB///////////////////////////////////////////////////////////////////AP//////////////////////////////////////gAAAAAAA+AAAAAAAH//gAAP/AAAAAAAB/////8AAB/+AAAAAAA////AAAP//4AAH//////////////////////////////////////////////////////////////////8A//////////////////////////////////////+AAAAAAAD4AAAAAAA///gAB/8AAAAAAAH/////8AAP/wAAAAAAf///8AAA///gAAf//////////////////////////////////////////////////////////////////wD//////////////////////////////////////4AAAAAAAPgAAAAAAD///gAH/wAAAAAAAf/////8AA//AAAAAAP////wAAD//+AAB///////////////////////////////////////////////////////////////////AP//////////////////////////////////////gf////wA+AAAAAAAP///gA//A/////gB//////8AH/+AAAAA//////AAAP//8AAH//////////////////////////////////////////////////////////////////8A///////////////////////////////////////////////////////////wD////////////////+Af/////////////////////////////////////////////////////////////////////////////////////////wD///////////////////////////////////////////////////////////4f/////////////////D//////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wD/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////AP////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8A/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////wA=";

        public void WriteData() {
            try {
                // 1 - magnetic coercivity to high
                // (calidad de la banda magnetica, negra o marron?)
                ExecStepOrFail(
                    () => Services.CmdSend("WRITE1", $"Pmc;{COERCIVITY}"),
                    "Coercivity");

                // 2 - magnetic track format
                ExecStepOrFail(
                    () => Services.CmdSend("WRITE2", $"Pmt;{TRACK};{FORMAT}"),
                    "ISO1");

                // 3 - sequence start
                ExecStepOrFail(
                    () => Services.CmdSend("WRITE3", "Ss"),
                    "SequenceStart");

                // 4 - download data inside magnetic buffer track
                ExecStepOrFail(
                    () => Services.CmdSend("WRITE4", $"Dm;{TRACK};{_client.IdCard}"),
                    "DownloadData");

                // 5 - write magnetic track
                // Este proceso suele demorar más. 30 segs de timeout
                ExecStepOrFail(
                    () => Services.CmdSend("WRITE5", "Smw", 30000),
                    "WriteTrack");

                // 6 - read and check
                var res = Services.CmdSend("WRITE6", $"Rmb;{TRACK}");
                if(res != _client.IdCard)
                    throw new Exception("Los datos no se grabaron correctamente. " +
                                        $"({res} != {_client.IdCard})");

                //// 6 - eject?
                //ExecStepOrFail(
                //    () => Services.CmdSend("WRITE7", "Se", 30000),
                //    "Eject");
                

            } catch (Exception ex) {
                throw new Exception("Error al escribir banda magnetica", ex);
            }
        }

        private static string TimeStamp =>
            $"{DateTime.Now:yyyy-MM-dd-HH-mm-ss}";

        private string GetBmpFilePath(string ext) {
            var p = Path.GetFullPath("./bmp");
            if (!Directory.Exists(p))
                Directory.CreateDirectory(p);
            return Path.Combine(p, $"{TimeStamp}.{ext}");
        }

        private string FullNameDisplay => 
            $"{_client?.Name?.ToUpper()} {_client?.LastName?.ToUpper()}";

        public void CreateImage() {
            try {
                var colorBmp = new Bitmap(1016, 648, PixelFormat.Format24bppRgb);
                var graph = Graphics.FromImage(colorBmp);
                graph.FillRectangle(
                    Brushes.White, 0, 0, colorBmp.Width, colorBmp.Height);
                graph.SmoothingMode = SmoothingMode.None;
                graph.InterpolationMode = InterpolationMode.Low;
                graph.PixelOffsetMode = PixelOffsetMode.HighQuality;
                graph.DrawString(FullNameDisplay, 
                    FontUtils.Roboto(Config.CardNameSize, FontStyle.Bold), 
                    Brushes.Black, 
                    Config.CardNameX, 
                    Config.CardNameY);

                graph.Flush();

                // Esta conversion es necesaria para reducir el tamaño del base64.
                // (Por más que la imagen no tenga colores)
                _image = GraphUtils.ConvertTo1Bpp(colorBmp);

                if(Config.DebugMode)
                    _image.Save(GetBmpFilePath("bmp"), ImageFormat.Bmp);
            }
            catch (Exception ex) {
                Die("Error al crear imagen BMP de la tarjeta", ex);
            }
        }

        public string GetImageBase64() {
            try {
                DieIf(_image == null, "La imagen aun no fue creada.");
                var stream = new MemoryStream();
                _image.Save(stream, System.Drawing.Imaging.ImageFormat.Bmp);
                var imageBytes = stream.ToArray();
                var base64 = Convert.ToBase64String(imageBytes);
                if (Config.DebugMode) {
                    File.WriteAllText(
                        GetBmpFilePath("txt"),
                        base64);
                }
                Debug.WriteLine($"Base64 Image Length: {base64.Length}");
                return $"base64:{base64}";
            }
            catch (Exception ex) {
                Die($"Error al convertir imagen a Base64.", ex);
                return null;
            }
        }
    }
}
